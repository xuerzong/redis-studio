---
import { CheckIcon, CopyIcon, DownloadIcon } from '@lucide/astro'
import GithubIcon from '@web/components/icons/GithubIcon.astro'
import LinuxIcon from '@web/components/icons/LinuxIcon.astro'
import AppleIcon from '@web/components/icons/AppleIcon.astro'
import WindowsIcon from '@web/components/icons/WindowsIcon.astro'
import LanguageSelect from '@web/components/LanguageSelect.astro'

const lang = Astro.currentLocale
const locales = {
  zh: {
    title: 'Redis Studio',
    description: 'ğŸš€ è½»é‡çº§ã€è·¨å¹³å°çš„ Redis GUIï¼ˆå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼‰',
    download: 'ä¸‹è½½åº”ç”¨',
    caption: 'é€‚ç”¨äº Macã€Windows å’Œ Linux',
  },
  en: {
    title: 'Redis Studio',
    description: 'ğŸš€ A lightweight, cross-platform Redis GUI Client.',
    download: 'Download',
    caption: 'Available for Mac, Windows, and Linux',
  },
}
const locale = locales[lang as 'zh' | 'en']
---

<main
  class="relative min-h-screen flex flex-col justify-center max-w-3xl mx-auto"
>
  <section>
    <div class="absolute top-4 right-4">
      <LanguageSelect />
    </div>
    <div class="text-center py-8">
      <div class="text-center mb-4">
        <img class="inline-block w-16 h-16" src="/favicon.png" />
      </div>

      <h1 class="text-6xl font-bold mb-4">{locale.title}</h1>

      <p class="text-md">{locale.description}</p>
    </div>
    <div class="flex items-center justify-center space-x-4">
      <a
        class="flex bg-red-400 py-2 px-4 rounded ring-2 ring-red-400/25 items-center space-x-2 cursor-pointer"
        href="https://github.com/xuerzong/redis-studio/releases"
        target="_blank"
        rel="noopener noreferrer"
        type="button"
      >
        <DownloadIcon class="w-4 h-4" />
        <span>{locale.download}</span>
      </a>

      <a
        class="flex bg-black text-white py-2 px-4 rounded items-center space-x-2 cursor-pointer"
        href="https://github.com/xuerzong/redis-studio"
        target="_blank"
        rel="noopener noreferrer"
        type="button"
      >
        <GithubIcon class="w-4 h-4" />
        <span>Github</span>
      </a>
    </div>
    <p class="text-center text-sm mt-1 text-gray-800">
      <span class="inline-flex items-center space-x-1">
        <AppleIcon class="w-3 h-3" />
        <WindowsIcon class="w-3 h-3" />
        <LinuxIcon class="w-3 h-3" />
      </span>
      <span>{locale.caption}</span>
    </p>
  </section>

  <section class="py-4">
    <div
      id="npm-bash-code-block"
      class="max-w-lg mx-auto relative font-mono border rounded-md text-sm py-2 px-4 bg-gray-900 text-gray-50"
    >
      <span class="text-green-500">npm</span>
      <span class="text-yellow-500">install </span>
      <span>@xuerzong/redis-studio</span>
      <span>-g</span>

      <CopyIcon
        id="copy-button"
        class="absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 cursor-pointer"
      />

      <CheckIcon
        id="copy-success-button"
        style={{ display: 'none' }}
        class="absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 cursor-pointer"
      />
    </div>
  </section>
</main>

<script>
  import copy from 'copy-to-clipboard'
  const copyButton = document.getElementById('copy-button')
  const copySuccessButton = document.getElementById('copy-success-button')
  const npmBashCodeBlock = document.getElementById('npm-bash-code-block')

  if (copyButton && copySuccessButton) {
    const onCopy = () => {
      const copyContent = npmBashCodeBlock?.textContent
      if (copyContent) {
        copy(copyContent)
        copyButton.style.display = 'none'
        copySuccessButton.style.display = 'block'
        setTimeout(() => {
          copyButton.style.display = 'block'
          copySuccessButton.style.display = 'none'
        }, 3000)
      }
    }

    copyButton.addEventListener('click', () => {
      onCopy()
    })
  }
</script>
